.macro save_caller_registers
	push 	%rax
	push 	%rcx
	push 	%rdx
	push 	%rsi
	push 	%rdi
	push 	%r8
	push 	%r9
	push 	%r10
	push 	%r11
.endm

.macro restore_caller_registers
	pop		%r11
	pop		%r10
	pop		%r9
	pop		%r8
	pop		%rdi
	pop		%rsi
	pop		%rdx
	pop		%rcx
	pop		%rax
.endm

.macro save_callee_registers
	push	%rbx
	push	%rbp
	push	%r12
	push	%r13
	push	%r14
	push	%r15
.endm

.macro restore_callee_registers
	pop		%r15
	pop		%r14
	pop		%r13
	pop		%r12
	pop		%rbp
	pop		%rbx
.endm

.macro define_hook index
.data
addr\index: .quad 0
.section .text
.global _plt_hook\index
_plt_hook\index:
	save_callee_registers

	save_caller_registers
	mov		 $\index, %rdi
	callq  disp_hook_start@plt
	mov		 addr\index@GOTPCREL(%rip), %rax
	mov		120(%rsp), %rcx
	mov		%rcx, 0(%rax)
	restore_caller_registers

	restore_callee_registers

	mov		 plt_functions@GOTPCREL(%rip),%rax
	mov    \index(%rax),%rax
	//jmpq   *%rax
	
	add  		$8, %rsp
	callq	 *%rax

	mov		 addr\index@GOTPCREL(%rip), %r11
	mov		0(%r11), %r11
	push 	%r11

	save_caller_registers
	mov		 $\index, %rdi
	callq  disp_hook_end@plt
	restore_caller_registers

	retq
.endm

# DO NOT DELETE THIS LINE 
define_hook "0"
define_hook "8"
define_hook "16"
define_hook "24"
define_hook "32"
define_hook "40"
define_hook "48"
define_hook "56"
define_hook "64"
define_hook "72"
define_hook "80"
define_hook "88"
define_hook "96"
define_hook "104"
define_hook "112"
define_hook "120"
define_hook "128"
define_hook "136"
define_hook "144"
define_hook "152"
define_hook "160"
define_hook "168"
define_hook "176"
define_hook "184"
define_hook "192"
define_hook "200"
define_hook "208"
define_hook "216"
define_hook "224"
define_hook "232"
define_hook "240"
define_hook "248"
define_hook "256"
define_hook "264"
define_hook "272"
define_hook "280"
define_hook "288"
define_hook "296"
define_hook "304"
define_hook "312"
define_hook "320"
define_hook "328"
define_hook "336"
define_hook "344"
define_hook "352"
define_hook "360"
define_hook "368"
define_hook "376"
define_hook "384"
define_hook "392"
define_hook "400"
define_hook "408"
define_hook "416"
define_hook "424"
define_hook "432"
define_hook "440"
define_hook "448"
define_hook "456"
define_hook "464"
define_hook "472"
define_hook "480"
define_hook "488"
define_hook "496"
define_hook "504"
define_hook "512"
define_hook "520"
define_hook "528"
define_hook "536"
define_hook "544"
define_hook "552"
define_hook "560"
define_hook "568"
define_hook "576"
define_hook "584"
define_hook "592"
define_hook "600"
define_hook "608"
define_hook "616"
define_hook "624"
define_hook "632"
define_hook "640"
define_hook "648"
define_hook "656"
define_hook "664"
define_hook "672"
define_hook "680"
define_hook "688"
define_hook "696"
define_hook "704"
define_hook "712"
define_hook "720"
define_hook "728"
define_hook "736"
define_hook "744"
define_hook "752"
define_hook "760"
define_hook "768"
define_hook "776"
define_hook "784"
define_hook "792"
define_hook "800"
define_hook "808"
define_hook "816"
define_hook "824"
define_hook "832"
define_hook "840"
define_hook "848"
define_hook "856"
define_hook "864"
define_hook "872"
define_hook "880"
define_hook "888"
define_hook "896"
define_hook "904"
define_hook "912"
define_hook "920"
define_hook "928"
define_hook "936"
define_hook "944"
define_hook "952"
define_hook "960"
define_hook "968"
define_hook "976"
define_hook "984"
define_hook "992"
define_hook "1000"
define_hook "1008"
define_hook "1016"
define_hook "1024"
define_hook "1032"
define_hook "1040"
define_hook "1048"
define_hook "1056"
define_hook "1064"
define_hook "1072"
define_hook "1080"
define_hook "1088"
define_hook "1096"
define_hook "1104"
define_hook "1112"
define_hook "1120"
define_hook "1128"
define_hook "1136"
define_hook "1144"
define_hook "1152"
define_hook "1160"
define_hook "1168"
define_hook "1176"
define_hook "1184"
define_hook "1192"
define_hook "1200"
define_hook "1208"
define_hook "1216"
define_hook "1224"
define_hook "1232"
define_hook "1240"
define_hook "1248"
define_hook "1256"
define_hook "1264"
define_hook "1272"
define_hook "1280"
define_hook "1288"
define_hook "1296"
define_hook "1304"
define_hook "1312"
define_hook "1320"
define_hook "1328"
define_hook "1336"
define_hook "1344"
define_hook "1352"
define_hook "1360"
define_hook "1368"
define_hook "1376"
define_hook "1384"
define_hook "1392"
define_hook "1400"
define_hook "1408"
define_hook "1416"
define_hook "1424"
define_hook "1432"
define_hook "1440"
define_hook "1448"
define_hook "1456"
define_hook "1464"
define_hook "1472"
define_hook "1480"
define_hook "1488"
define_hook "1496"
define_hook "1504"
define_hook "1512"
define_hook "1520"
define_hook "1528"
define_hook "1536"
define_hook "1544"
define_hook "1552"
define_hook "1560"
define_hook "1568"
define_hook "1576"
define_hook "1584"
define_hook "1592"
define_hook "1600"
define_hook "1608"
define_hook "1616"
define_hook "1624"
define_hook "1632"
define_hook "1640"
define_hook "1648"
define_hook "1656"
define_hook "1664"
define_hook "1672"
define_hook "1680"
define_hook "1688"
define_hook "1696"
define_hook "1704"
define_hook "1712"
define_hook "1720"
define_hook "1728"
define_hook "1736"
define_hook "1744"
define_hook "1752"
define_hook "1760"
define_hook "1768"
define_hook "1776"
define_hook "1784"
define_hook "1792"
define_hook "1800"
define_hook "1808"
define_hook "1816"
define_hook "1824"
define_hook "1832"
define_hook "1840"
define_hook "1848"
define_hook "1856"
define_hook "1864"
define_hook "1872"
define_hook "1880"
define_hook "1888"
define_hook "1896"
define_hook "1904"
define_hook "1912"
define_hook "1920"
define_hook "1928"
define_hook "1936"
define_hook "1944"
define_hook "1952"
define_hook "1960"
define_hook "1968"
define_hook "1976"
define_hook "1984"
define_hook "1992"
define_hook "2000"
define_hook "2008"
define_hook "2016"
define_hook "2024"
define_hook "2032"
define_hook "2040"
define_hook "2048"
define_hook "2056"
define_hook "2064"
define_hook "2072"
define_hook "2080"
define_hook "2088"
define_hook "2096"
define_hook "2104"
define_hook "2112"
define_hook "2120"
define_hook "2128"
define_hook "2136"
define_hook "2144"
define_hook "2152"
define_hook "2160"
define_hook "2168"
define_hook "2176"
define_hook "2184"
define_hook "2192"
define_hook "2200"
define_hook "2208"
define_hook "2216"
define_hook "2224"
define_hook "2232"
define_hook "2240"
define_hook "2248"
define_hook "2256"
define_hook "2264"
define_hook "2272"
define_hook "2280"
define_hook "2288"
define_hook "2296"
define_hook "2304"
define_hook "2312"
define_hook "2320"
define_hook "2328"
define_hook "2336"
define_hook "2344"
define_hook "2352"
define_hook "2360"
define_hook "2368"
define_hook "2376"
define_hook "2384"
define_hook "2392"
define_hook "2400"
define_hook "2408"
define_hook "2416"
define_hook "2424"
define_hook "2432"
define_hook "2440"
define_hook "2448"
define_hook "2456"
define_hook "2464"
define_hook "2472"
define_hook "2480"
define_hook "2488"
define_hook "2496"
define_hook "2504"
define_hook "2512"
define_hook "2520"
define_hook "2528"
define_hook "2536"
define_hook "2544"
define_hook "2552"
define_hook "2560"
define_hook "2568"
define_hook "2576"
define_hook "2584"
define_hook "2592"
define_hook "2600"
define_hook "2608"
define_hook "2616"
define_hook "2624"
define_hook "2632"
define_hook "2640"
define_hook "2648"
define_hook "2656"
define_hook "2664"
define_hook "2672"
define_hook "2680"
define_hook "2688"
define_hook "2696"
define_hook "2704"
define_hook "2712"
define_hook "2720"
define_hook "2728"
define_hook "2736"
define_hook "2744"
define_hook "2752"
define_hook "2760"
define_hook "2768"
define_hook "2776"
define_hook "2784"
define_hook "2792"
define_hook "2800"
define_hook "2808"
define_hook "2816"
define_hook "2824"
define_hook "2832"
define_hook "2840"
define_hook "2848"
define_hook "2856"
define_hook "2864"
define_hook "2872"
define_hook "2880"
define_hook "2888"
define_hook "2896"
define_hook "2904"
define_hook "2912"
define_hook "2920"
define_hook "2928"
define_hook "2936"
define_hook "2944"
define_hook "2952"
define_hook "2960"
define_hook "2968"
define_hook "2976"
define_hook "2984"
define_hook "2992"
define_hook "3000"
define_hook "3008"
define_hook "3016"
define_hook "3024"
define_hook "3032"
define_hook "3040"
define_hook "3048"
define_hook "3056"
define_hook "3064"
define_hook "3072"
define_hook "3080"
define_hook "3088"
define_hook "3096"
define_hook "3104"
define_hook "3112"
define_hook "3120"
define_hook "3128"
define_hook "3136"
define_hook "3144"
define_hook "3152"
define_hook "3160"
define_hook "3168"
define_hook "3176"
define_hook "3184"
define_hook "3192"
define_hook "3200"
define_hook "3208"
define_hook "3216"
define_hook "3224"
define_hook "3232"
define_hook "3240"
define_hook "3248"
define_hook "3256"
define_hook "3264"
define_hook "3272"
define_hook "3280"
define_hook "3288"
define_hook "3296"
define_hook "3304"
define_hook "3312"
define_hook "3320"
define_hook "3328"
define_hook "3336"
define_hook "3344"
define_hook "3352"
define_hook "3360"
define_hook "3368"
define_hook "3376"
define_hook "3384"
define_hook "3392"
define_hook "3400"
define_hook "3408"
define_hook "3416"
define_hook "3424"
define_hook "3432"
define_hook "3440"
define_hook "3448"
define_hook "3456"
define_hook "3464"
define_hook "3472"
define_hook "3480"
define_hook "3488"
define_hook "3496"
define_hook "3504"
define_hook "3512"
define_hook "3520"
define_hook "3528"
define_hook "3536"
define_hook "3544"
define_hook "3552"
define_hook "3560"
define_hook "3568"
define_hook "3576"
define_hook "3584"
define_hook "3592"
define_hook "3600"
define_hook "3608"
define_hook "3616"
define_hook "3624"
define_hook "3632"
define_hook "3640"
define_hook "3648"
define_hook "3656"
define_hook "3664"
define_hook "3672"
define_hook "3680"
define_hook "3688"
define_hook "3696"
define_hook "3704"
define_hook "3712"
define_hook "3720"
define_hook "3728"
define_hook "3736"
define_hook "3744"
define_hook "3752"
define_hook "3760"
define_hook "3768"
define_hook "3776"
define_hook "3784"
define_hook "3792"
define_hook "3800"
define_hook "3808"
define_hook "3816"
define_hook "3824"
define_hook "3832"
define_hook "3840"
define_hook "3848"
define_hook "3856"
define_hook "3864"
define_hook "3872"
define_hook "3880"
define_hook "3888"
define_hook "3896"
define_hook "3904"
define_hook "3912"
define_hook "3920"
define_hook "3928"
define_hook "3936"
define_hook "3944"
define_hook "3952"
define_hook "3960"
define_hook "3968"
define_hook "3976"
define_hook "3984"
define_hook "3992"
define_hook "4000"
define_hook "4008"
define_hook "4016"
define_hook "4024"
define_hook "4032"
define_hook "4040"
define_hook "4048"
define_hook "4056"
define_hook "4064"
define_hook "4072"
define_hook "4080"
define_hook "4088"
define_hook "4096"
define_hook "4104"
define_hook "4112"
define_hook "4120"
define_hook "4128"
define_hook "4136"
define_hook "4144"
define_hook "4152"
define_hook "4160"
define_hook "4168"
define_hook "4176"
define_hook "4184"
define_hook "4192"
define_hook "4200"
define_hook "4208"
define_hook "4216"
define_hook "4224"
define_hook "4232"
define_hook "4240"
define_hook "4248"
define_hook "4256"
define_hook "4264"
define_hook "4272"
define_hook "4280"
define_hook "4288"
define_hook "4296"
define_hook "4304"
define_hook "4312"
define_hook "4320"
define_hook "4328"
define_hook "4336"
define_hook "4344"
define_hook "4352"
define_hook "4360"
define_hook "4368"
define_hook "4376"
define_hook "4384"
define_hook "4392"
define_hook "4400"
define_hook "4408"
define_hook "4416"
define_hook "4424"
define_hook "4432"
define_hook "4440"
define_hook "4448"
define_hook "4456"
define_hook "4464"
define_hook "4472"
define_hook "4480"
define_hook "4488"
define_hook "4496"
define_hook "4504"
define_hook "4512"
define_hook "4520"
define_hook "4528"
define_hook "4536"
define_hook "4544"
define_hook "4552"
define_hook "4560"
define_hook "4568"
define_hook "4576"
define_hook "4584"
define_hook "4592"
define_hook "4600"
define_hook "4608"
define_hook "4616"
define_hook "4624"
define_hook "4632"
define_hook "4640"
define_hook "4648"
define_hook "4656"
define_hook "4664"
define_hook "4672"
define_hook "4680"
define_hook "4688"
define_hook "4696"
define_hook "4704"
define_hook "4712"
define_hook "4720"
define_hook "4728"
define_hook "4736"
define_hook "4744"
define_hook "4752"
define_hook "4760"
define_hook "4768"
define_hook "4776"
define_hook "4784"
define_hook "4792"
define_hook "4800"
define_hook "4808"
define_hook "4816"
define_hook "4824"
define_hook "4832"
define_hook "4840"
define_hook "4848"
define_hook "4856"
define_hook "4864"
define_hook "4872"
define_hook "4880"
define_hook "4888"
define_hook "4896"
define_hook "4904"
define_hook "4912"
define_hook "4920"
define_hook "4928"
define_hook "4936"
define_hook "4944"
define_hook "4952"
define_hook "4960"
define_hook "4968"
define_hook "4976"
define_hook "4984"
define_hook "4992"
define_hook "5000"
define_hook "5008"
define_hook "5016"
define_hook "5024"
define_hook "5032"
define_hook "5040"
define_hook "5048"
define_hook "5056"
define_hook "5064"
define_hook "5072"
define_hook "5080"
define_hook "5088"
define_hook "5096"
define_hook "5104"
define_hook "5112"
define_hook "5120"
define_hook "5128"
define_hook "5136"
define_hook "5144"
define_hook "5152"
define_hook "5160"
define_hook "5168"
define_hook "5176"
define_hook "5184"
define_hook "5192"
define_hook "5200"
define_hook "5208"
define_hook "5216"
define_hook "5224"
define_hook "5232"
define_hook "5240"
define_hook "5248"
define_hook "5256"
define_hook "5264"
define_hook "5272"
define_hook "5280"
define_hook "5288"
define_hook "5296"
define_hook "5304"
define_hook "5312"
define_hook "5320"
define_hook "5328"
define_hook "5336"
define_hook "5344"
define_hook "5352"
define_hook "5360"
define_hook "5368"
define_hook "5376"
define_hook "5384"
define_hook "5392"
define_hook "5400"
define_hook "5408"
define_hook "5416"
define_hook "5424"
define_hook "5432"
define_hook "5440"
define_hook "5448"
define_hook "5456"
define_hook "5464"
define_hook "5472"
define_hook "5480"
define_hook "5488"
define_hook "5496"
define_hook "5504"
define_hook "5512"
define_hook "5520"
define_hook "5528"
define_hook "5536"
define_hook "5544"
define_hook "5552"
define_hook "5560"
define_hook "5568"
define_hook "5576"
define_hook "5584"
define_hook "5592"
define_hook "5600"
define_hook "5608"
define_hook "5616"
define_hook "5624"
define_hook "5632"
define_hook "5640"
define_hook "5648"
define_hook "5656"
define_hook "5664"
define_hook "5672"
define_hook "5680"
define_hook "5688"
define_hook "5696"
define_hook "5704"
define_hook "5712"
define_hook "5720"
define_hook "5728"
define_hook "5736"
define_hook "5744"
define_hook "5752"
define_hook "5760"
define_hook "5768"
define_hook "5776"
define_hook "5784"
define_hook "5792"
define_hook "5800"
define_hook "5808"
define_hook "5816"
define_hook "5824"
define_hook "5832"
define_hook "5840"
define_hook "5848"
define_hook "5856"
define_hook "5864"
define_hook "5872"
define_hook "5880"
define_hook "5888"
define_hook "5896"
define_hook "5904"
define_hook "5912"
define_hook "5920"
define_hook "5928"
define_hook "5936"
define_hook "5944"
define_hook "5952"
define_hook "5960"
define_hook "5968"
define_hook "5976"
define_hook "5984"
define_hook "5992"
define_hook "6000"
define_hook "6008"
define_hook "6016"
define_hook "6024"
define_hook "6032"
define_hook "6040"
define_hook "6048"
define_hook "6056"
define_hook "6064"
define_hook "6072"
define_hook "6080"
define_hook "6088"
define_hook "6096"
define_hook "6104"
define_hook "6112"
define_hook "6120"
define_hook "6128"
define_hook "6136"
define_hook "6144"
define_hook "6152"
define_hook "6160"
define_hook "6168"
define_hook "6176"
define_hook "6184"
define_hook "6192"
define_hook "6200"
define_hook "6208"
define_hook "6216"
define_hook "6224"
define_hook "6232"
define_hook "6240"
define_hook "6248"
define_hook "6256"
define_hook "6264"
define_hook "6272"
define_hook "6280"
define_hook "6288"
define_hook "6296"
define_hook "6304"
define_hook "6312"
define_hook "6320"
define_hook "6328"
define_hook "6336"
define_hook "6344"
define_hook "6352"
define_hook "6360"
define_hook "6368"
define_hook "6376"
define_hook "6384"
define_hook "6392"
define_hook "6400"
define_hook "6408"
define_hook "6416"
define_hook "6424"
define_hook "6432"
define_hook "6440"
define_hook "6448"
define_hook "6456"
define_hook "6464"
define_hook "6472"
define_hook "6480"
define_hook "6488"
define_hook "6496"
define_hook "6504"
define_hook "6512"
define_hook "6520"
define_hook "6528"
define_hook "6536"
define_hook "6544"
define_hook "6552"
define_hook "6560"
define_hook "6568"
define_hook "6576"
define_hook "6584"
define_hook "6592"
define_hook "6600"
define_hook "6608"
define_hook "6616"
define_hook "6624"
define_hook "6632"
define_hook "6640"
define_hook "6648"
define_hook "6656"
define_hook "6664"
define_hook "6672"
define_hook "6680"
define_hook "6688"
define_hook "6696"
define_hook "6704"
define_hook "6712"
define_hook "6720"
define_hook "6728"
define_hook "6736"
define_hook "6744"
define_hook "6752"
define_hook "6760"
define_hook "6768"
define_hook "6776"
define_hook "6784"
define_hook "6792"
define_hook "6800"
define_hook "6808"
define_hook "6816"
define_hook "6824"
define_hook "6832"
define_hook "6840"
define_hook "6848"
define_hook "6856"
define_hook "6864"
define_hook "6872"
define_hook "6880"
define_hook "6888"
define_hook "6896"
define_hook "6904"
define_hook "6912"
define_hook "6920"
define_hook "6928"
define_hook "6936"
define_hook "6944"
define_hook "6952"
define_hook "6960"
define_hook "6968"
define_hook "6976"
define_hook "6984"
define_hook "6992"
define_hook "7000"
define_hook "7008"
define_hook "7016"
define_hook "7024"
define_hook "7032"
define_hook "7040"
define_hook "7048"
define_hook "7056"
define_hook "7064"
define_hook "7072"
define_hook "7080"
define_hook "7088"
define_hook "7096"
define_hook "7104"
define_hook "7112"
define_hook "7120"
define_hook "7128"
define_hook "7136"
define_hook "7144"
define_hook "7152"
define_hook "7160"
define_hook "7168"
define_hook "7176"

